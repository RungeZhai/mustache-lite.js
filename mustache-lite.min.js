function render(e,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+Object.prototype.toString.call(e)+'" was given as the first argument for #render(template, view)');e=e.replace(/\n[^\S\n]*{{\s*(!|\^|#|\/)\s*((((?!}}).)+?)\s*[^}])}}[^\S\n]*\n/g,function(e,n,t,i,o){var a="function"==typeof evalProp(r,t=t.trim())&&"#"===n;return"\n{{"+n+t+"}}"+(a?"\n":"")});for(var n,t=/{{(\^|#)(.+?)}}([^]+?){{\/\2}}/g,i=t.lastIndex=0,o="";n=t.exec(e);){var a=n[2],l=n[1],c=n[3],s=e.substring(i,n.index);o+=renderSingleSection(s,r);var u=evalProp(r,a);if("#"===l&&u){var f=Object.prototype.toString.call(u);"[object Array]"===f?u.forEach(function(e){o+=render(c,e)}):"[object Object]"===f?(u.parent=r,o+=render(c,u)):o+="[object Function]"===f?u.call(r,c,function(e){return renderSingleSection(e,r)}):render(c,r)}else"^"!==l||u||(o+=render(c,r));i=t.lastIndex}return o+=renderSingleSection(e.substring(i),r)}function renderSingleSection(e,r){var n,t=/{{{%(.+?)%}}}|{{{\s*(.+?)\s*}}}|{{&\s*(.+?)\s*}}|{{%(.+?)%}}|{{\s*(.+?)\s*}}/g,i=t.lastIndex=0,o="";for(e=e;n=t.exec(e);){o+=e.substring(i,n.index);var a=n[1]||n[2]||n[3]||n[4]||n[5],l=n[5]||n[4],c=n[1]||n[4]||evalProp(r,a);void 0!==c&&null!==c&&(o+=l?escapeHtml(""+c):c),i=t.lastIndex}return o+=e.substring(i)}function evalProp(e,r){for(var n,t=e,i=!1;n=t;){if("."!==(r=r.trim()))for(var o=r.split("."),a=0;a<o.length;++a){var l=o[a].trim();if(a===o.length-1&&(i="object"==typeof n&&l in n),n=n[l],void 0===n||null===n)break}else i=!0;if(i)break;t=t.parent}return"function"==typeof n?n.call(e):n}function escapeHtml(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return entityMap[e]})}var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};